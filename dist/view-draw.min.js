/**
 * view-draw 0.0.1
 * @license MIT
 * Copyright 2021-present Jasper Palfree
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).ViewDraw={})}(this,(function(t){"use strict";var e=function(t,e,n){return t*(1-n)+e*n},n=function(t,e,n){var i=e-t;return i?(n-t)/i:1},i=function(t,n){return[e(n[0],n[1],t[0]),e(n[2],n[3],t[1])]},r=function(t,e){return[n(e[0],e[1],t[0]),n(e[2],e[3],t[1])]},o=function(t,e){var n=t.name,o=t.to,a=t.from;void 0===e&&(e=[0,1,0,1]);var s={name:n,to:o,from:a,viewbox:e,toCameraSize:function(t,e){return(t[1]-t[0])*e/(s.viewbox[1]-s.viewbox[0])},fromCameraSize:function(t,e){var n=t[1]-t[0];return(s.viewbox[1]-s.viewbox[0])*e/n},toCamera:function(t,e){return i(o(r(e,s.viewbox)),t)},fromCamera:function(t,e){return i(a(r(e,t)),s.viewbox)}};return s},a=2*Math.PI,s={to:function(t){return t},from:function(t){return t}},c={to:function(t){var e=t[0],n=t[1];return n*=a,[e*Math.cos(n),e*Math.sin(n)]},from:function(t){var e=t[0],n=t[1];return[Math.sqrt(e*e+n*n),Math.atan2(n,e)/a]}},u=Object.freeze({__proto__:null,makeProjection:o,cartesian:s,polar:c});var h=function(){function t(t,e){this.proj=t,this.options=e}t.create=function(e,n){return void 0===n&&(n={}),new t(e,n)};var e=t.prototype;return e.init=function(t,e){t!==this.canvas&&(this.canvas=t,this.ctx=t.getContext("2d")),this.width=t.width,this.height=t.height,this.bounds=t.getBoundingClientRect();var n=this.width/this.bounds.width,i=.5*this.width/n,r=.5*this.height/n,o="fit"===this.options.scaleMode?Math.min(i,r):Math.max(i,r),a=o*e.scale,s=this.proj.to(e.center);return this.cameraBounds=[-s[0]*a+i,(1-s[0])*a+i,-s[1]*a+r,(1-s[1])*a+r],this.worldUnit=[0,o,0,o],this.worldScale=[0,a,0,a],this.ctx.setTransform(n,0,0,n,0,0),this},e.save=function(){this.ctx.save()},e.restore=function(){this.ctx.restore()},e.clear=function(){this.ctx.clearRect(0,0,this.width,this.height)},e.color=function(t){return this.ctx.fillStyle!==t&&(this.ctx.fillStyle=t),this.ctx.strokeStyle!==t&&(this.ctx.strokeStyle=t),this},e.style=function(t,e){if(void 0!==e)return this.ctx[t]=e,this;for(var n in t){var i=t[n];this.ctx[n]!==i&&(this.ctx[n]=i)}return this},e.translate=function(t){var e=this.ctx,n=this.proj.toCamera(this.worldScale,t),i=n[0],r=n[1];return e.translate(i,r),this},e.rotate=function(t){var e=this.proj.toCamera(this.cameraBounds,[0,0]);return this.ctx.translate(e[0],e[1]),this.ctx.rotate(t),this.ctx.translate(-e[0],-e[1]),this},e.dot=function(t){var e=this.ctx,n=this.proj.toCamera(this.cameraBounds,t),i=n[0],r=n[1];return e.beginPath(),e.arc(i,r,1,0,2*Math.PI),e.fill(),this},e.paint=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=0);var n=this.ctx;return t&&n.fill(),e&&(this.style("lineWidth",e),n.stroke()),this},e.circle=function(t,e,n,i){void 0===n&&(n=!0),void 0===i&&(i=0);var r=this.ctx,o=this.proj.toCamera(this.cameraBounds,t),a=o[0],s=o[1];return e=this.proj.toCameraSize(this.cameraBounds,e),r.beginPath(),r.arc(a,s,e,0,2*Math.PI),this.paint(n,i),this},e.path=function(t,e,n,i){void 0===e&&(e=!1);var r=this.ctx;r.beginPath();var o=this.proj.toCamera(this.cameraBounds,t[0]);r.moveTo(o[0],o[1]);for(var a=1,s=t.length;a<s;a++)o=this.proj.toCamera(this.cameraBounds,t[a]),r.lineTo(o[0],o[1]);return e&&r.closePath(),this.paint(n,i),this},e.triangle=function(t,e,n,i,r,o,a){var s=void 0===i?[0,0]:i,c=s[0],u=s[1];void 0===r&&(r=0);for(var h=function(t,e,n){var i=Math.max(t,e,n);if(i===t){var r=[n,t];t=r[0],n=r[1]}else if(i===e){var o=[n,e];e=o[0],n=o[1]}var a=0===t?0:(t*t-e*e+n*n)/(2*n);return[[0,0],[a,Math.sqrt(t*t-a*a)],[n,0]]}(t,e,n),d=function(t){for(var e=0,n=0,i=t.length,r=0;r<i;r++){var o=t[r];e+=o[0],n+=o[1]}return[e/i,n/i]}(h),v=d[0],f=d[1],l=0,m=h.length;l<m;l++)h[l][0]-=v,h[l][1]-=f;return this.save(),this.translate([c,u]),this.rotate(r),this.path(h,!0,o,a),this.restore(),this},t}();var d=function(t,e){void 0===t&&(t=[0,0]),void 0===e&&(e={});var n,i,r,o,a,s=Object.assign({friction:.02,threshold:.001},e),c=!1,u=t,h=0,d=[],v=window.performance.now.bind(window.performance);function f(t,e){void 0===e&&(e=1),c&&(d=u.slice(0),u[0]=n[0]+(t[0]-c[0])/e,u[1]=n[1]+(t[1]-c[1])/e,a=v())}return{start:function(t){c=t,n=u.slice(0)},drag:f,stop:function(t,e){if(c){i=d[0],r=d[1];var n=Math.max(20,v()-a);f(t,e),i=4*(u[0]-i)/n,r=4*(u[1]-r)/n,o=Math.sqrt(i*i+r*r),c=!1}},update:function(){var t=v();return c||function(t){if(i||r){var e=t-h;u[0]+=i*e,u[1]+=r*e,i&&(i-=s.friction*i),r&&(r-=s.friction*r),(i*i+r*r)/(o*o)<s.threshold*s.threshold&&(i=r=0)}}(t),h=t,u}}};t.createCanvas=function(t){var e=void 0===t?{}:t,n=e.autoResize,i=void 0===n||n,r=e.pixelRatio,o=void 0===r?window.devicePixelRatio||1:r,a=e.width,s=void 0===a?0:a,c=e.height,u=void 0===c?0:c,h=e.aspectRatio,d=void 0===h?null:h,v=e.el,f=void 0===v?document.body:v,l=e.background,m=void 0===l?"hsl(0, 0%, 10%)":l,p=e.onResize,w=void 0===p?function(){}:p,g="CANVAS"===f.tagName?f:document.createElement("canvas"),x=g.getContext("2d"),y=!s,b=!u,C={};g.style.display="flex",g.style.background=m,g.style.transform="scale("+1/o+")",g.style.transformOrigin="top left","CANVAS"!==f.tagName&&f.appendChild(g);var M=function(){var t=g.parentNode;t&&(y&&(s=t.clientWidth),b&&(u=d?s/d:t.clientHeight),C.width=s,C.height=u,g.style.marginBottom=(1-o)*u+"px",g.width=o*s,g.height=o*u,x.scale(o,o),w(C))};return i&&window.addEventListener("resize",M),M(),{canvas:g,ctx:x,destroy:function(){i&&window.removeEventListener("resize",M),g.parentNode&&g.parentNode.removeChild(g)},dimensions:C,refresh:M}},t.createDragger=d,t.createView=function(t,e,n,i){void 0===i&&(i={scaleMode:"fit"}),"string"==typeof t?t=u[t]:"object"!==t&&(n=e,e=t,t=s),Array.isArray(e)||(n=e,e=void 0);var r=o(t,e),a={center:[0,0],scale:1,proj:r},c=h.create(r,i);return a.toViewCoords=function(t,e,n){return void 0===n&&(n=!1),c.init(e,a),r.fromCamera(n?c.worldUnit:c.cameraBounds,t)},a.getMousePos=function(t,e,n){void 0===n&&(n=!1),c.init(e,a);var i=[t.pageX-c.bounds.left,t.pageY-c.bounds.top];return a.toViewCoords(i,e,n)},a.camera=function(t,e){return void 0===e&&(e=1),a.center=t,a.scale=e,a},a.draw=function(t){c.init(t,a),c.clear();for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return n.apply(void 0,[c].concat(i)),a},a.drawOver=function(t){c.init(t,a);for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return n.apply(void 0,[c].concat(i)),a},a},t.createViewport=function(t,e){void 0===e&&(e={});var n={center:[0,0],zoom:1},i=function(e){var n=t.getBoundingClientRect();return[-(e.pageX-n.left),-(e.pageY-n.top)]},r=d(n.center,e),o=function(t){t.preventDefault(),n.zoom=function(t,e,n){return void 0===n&&(n=1),t.zoom*Math.pow(2,e*n)}(n,-t.deltaY,.001)},a=function(t){r.start(i(t))},s=function(t){r.drag(i(t),n.zoom)},c=function(t){r.stop(i(t),n.zoom)};return t.addEventListener("wheel",o),t.addEventListener("mousedown",a),t.addEventListener("mousemove",s),window.addEventListener("mouseup",c),{state:n,update:function(){return n.center=r.update(),n},cleanup:function(){t.removeEventListener("wheel",o),t.removeEventListener("mousedown",a),t.removeEventListener("mousemove",s),window.removeEventListener("mouseup",c)}}},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlldy1kcmF3Lm1pbi5qcyIsInNvdXJjZXMiOltdLCJzb3VyY2VzQ29udGVudCI6W10sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIifQ==
