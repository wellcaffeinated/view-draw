/**
 * view-draw 1.0.0
 * @license MIT
 * Copyright 2021-present Jasper Palfree
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ViewDraw={})}(this,(function(e){"use strict";var t=function(e,t,n){return e*(1-n)+t*n},n=function(e,t,n){var o=t-e;return o?(n-e)/o:1},o=function(e,n){return[t(n[0],n[1],e[0]),t(n[2],n[3],e[1])]},r=function(e,t){return[n(t[0],t[1],e[0]),n(t[2],t[3],e[1])]},i=function(e,t){var n=e.name,i=e.to,a=e.from;void 0===t&&(t=[0,1,0,1]);var c={name:n,to:i,from:a,viewbox:t,toCameraSize:function(e,t){return(e[1]-e[0])*t/(c.viewbox[1]-c.viewbox[0])},fromCameraSize:function(e,t){var n=e[1]-e[0];return(c.viewbox[1]-c.viewbox[0])*t/n},toCamera:function(e,t){return o(i(r(t,c.viewbox)),e)},fromCamera:function(e,t){return o(a(r(t,e)),c.viewbox)}};return c},a=2*Math.PI,c={to:function(e){return e},from:function(e){return e}},u={to:function(e){var t=e[0],n=e[1];return n*=a,[t*Math.cos(n),t*Math.sin(n)]},from:function(e){var t=e[0],n=e[1];return[Math.sqrt(t*t+n*n),Math.atan2(n,t)/a]}},d=Object.freeze({__proto__:null,makeProjection:i,cartesian:c,polar:u});var s=function(e,t){void 0===e&&(e=[0,0]),void 0===t&&(t={});var n,o,r,i,a,c=Object.assign({friction:.02,threshold:.001},t),u=!1,d=e,s=0,f=[],v=window.performance.now.bind(window.performance);function l(e,t){void 0===t&&(t=1),u&&(f=d.slice(0),d[0]=n[0]+(e[0]-u[0])/t,d[1]=n[1]+(e[1]-u[1])/t,a=v())}return{start:function(e){u=e,n=d.slice(0)},drag:l,stop:function(e,t){if(u){o=f[0],r=f[1];var n=Math.max(20,v()-a);l(e,t),o=4*(d[0]-o)/n,r=4*(d[1]-r)/n,i=Math.sqrt(o*o+r*r),u=!1}},update:function(){var e=v();return u||function(e){if(o||r){var t=e-s;d[0]+=o*t,d[1]+=r*t,o&&(o-=c.friction*o),r&&(r-=c.friction*r),(o*o+r*r)/(i*i)<c.threshold*c.threshold&&(o=r=0)}}(e),s=e,d}}};e.createCanvas=function(e){var t=void 0===e?{}:e,n=t.autoResize,o=void 0===n||n,r=t.pixelRatio,i=void 0===r?window.devicePixelRatio||1:r,a=t.width,c=void 0===a?0:a,u=t.height,d=void 0===u?0:u,s=t.aspectRatio,f=void 0===s?16/9:s,v=t.parent,l=void 0===v?document.body:v,h=t.background,m=void 0===h?"hsl(0, 0%, 10%)":h,w=t.onResize,p=void 0===w?function(){}:w,g=document.createElement("div"),x=document.createElement("canvas"),y=x.getContext("2d"),b=!c,C=!d,z={};g.style.overflow="hidden",x.style.background=m,x.style.transform="scale("+1/i+")",x.style.transformOrigin="top left";var M=function(){b&&(c=l.offsetWidth),C&&(d=c/f),z.width=c,z.height=d,x.width=i*c,x.height=i*d,g.style.width=c+"px",g.style.height=d+"px",p(z)};return g.appendChild(x),l.appendChild(g),o&&window.addEventListener("resize",M),M(),{canvas:x,ctx:y,destroy:function(){o&&window.removeEventListener("resize",M),x.parentNode.removeChild(x)},dimensions:z}},e.createDragger=s,e.createView=function(e,t,n){"string"==typeof e?e=d[e]:"object"!==e&&(n=t,t=e,e=c),Array.isArray(t)||(n=t,t=void 0);var o=i(e,t),r={center:[0,0],scale:1,proj:o},a={proj:o,init:function(e){e!==a.canvas&&(a.canvas=e,a.ctx=e.getContext("2d")),a.width=e.width,a.height=e.height,a.bounds=e.getBoundingClientRect();var t=a.width/a.bounds.width,n=.5*a.width/t,i=.5*a.height/t,c=Math.max(n,i),u=o.to(r.center);return a.cameraBounds=[-u[0]*c+n,(r.scale-u[0])*c+n,-u[1]*c+i,(r.scale-u[1])*c+i],a.worldScale=[0,-c,0,-c],a.ctx.setTransform(t,0,0,t,0,0),a},clear:function(){a.ctx.clearRect(0,0,a.width,a.height)},color:function(e){return a.ctx.fillStyle!==e&&(a.ctx.fillStyle=e),a.ctx.strokeStyle!==e&&(a.ctx.strokeStyle=e),a},style:function(e,t){if(void 0!==t)return a.ctx[e]=t,a;for(var n in e){var o=e[n];a.ctx[n]!==o&&(a.ctx[n]=o)}return a},dot:function(e){var t=a.ctx,n=o.toCamera(a.cameraBounds,e),r=n[0],i=n[1];t.beginPath(),t.arc(r,i,1,0,2*Math.PI),t.fill()},circle:function(e,t,n,r){void 0===n&&(n=!0),void 0===r&&(r=0);var i=a.ctx,c=o.toCamera(a.cameraBounds,e),u=c[0],d=c[1];return t=o.toCameraSize(a.cameraBounds,t),i.beginPath(),i.arc(u,d,t,0,2*Math.PI),n&&i.fill(),r&&(a.style("lineWidth",r),i.stroke()),a}};return r.toViewCoords=function(e,t,n){return void 0===n&&(n=!1),a.init(t),o.fromCamera(n?a.worldScale:a.cameraBounds,e)},r.getMousePos=function(e,t,n){void 0===n&&(n=!1);var o=[e.pageX-a.bounds.left,e.pageY-a.bounds.top];return r.toViewCoords(o,t,n)},r.camera=function(e,t){return void 0===t&&(t=1),r.center=e,r.scale=t,r},r.draw=function(e){a.init(e),a.clear();for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,[a].concat(o)),r},r.drawOver=function(e){a.init(e);for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,[a].concat(o)),r},r},e.createViewport=function(e,t){void 0===t&&(t={});var n={center:[0,0],zoom:1},o=function(t){var n=e.getBoundingClientRect();return[-(t.pageX-n.left)/n.width,-(t.pageY-n.top)/n.height]},r=s(n.center,t),i=function(e){e.preventDefault(),n.zoom=function(e,t,n){return void 0===n&&(n=1),e.zoom*Math.pow(2,t*n)}(n,-e.deltaY,.001)},a=function(e){r.start(o(e))},c=function(e){r.drag(o(e),n.zoom)},u=function(e){r.stop(o(e),n.zoom)};return e.addEventListener("wheel",i),e.addEventListener("mousedown",a),e.addEventListener("mousemove",c),window.addEventListener("mouseup",u),{state:n,update:function(){return n.center=r.update(),n},cleanup:function(){e.removeEventListener("wheel",i),e.removeEventListener("mousedown",a),e.removeEventListener("mousemove",c),window.removeEventListener("mouseup",u)}}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlldy1kcmF3Lm1pbi5qcyIsInNvdXJjZXMiOltdLCJzb3VyY2VzQ29udGVudCI6W10sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIifQ==
