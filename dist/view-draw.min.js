/**
 * view-draw 0.0.1
 * @license MIT
 * Copyright 2021-present Jasper Palfree
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ViewDraw={})}(this,(function(e){"use strict";var t=function(e,t,n){return e*(1-n)+t*n},n=function(e,t,n){var r=t-e;return r?(n-e)/r:1},r=function(e,n){return[t(n[0],n[1],e[0]),t(n[2],n[3],e[1])]},o=function(e,t){return[n(t[0],t[1],e[0]),n(t[2],t[3],e[1])]},i=function(e,t){var n=e.name,i=e.to,a=e.from;void 0===t&&(t=[0,1,0,1]);var c={name:n,to:i,from:a,viewbox:t,toCameraSize:function(e,t){return(e[1]-e[0])*t/(c.viewbox[1]-c.viewbox[0])},fromCameraSize:function(e,t){var n=e[1]-e[0];return(c.viewbox[1]-c.viewbox[0])*t/n},toCamera:function(e,t){return r(i(o(t,c.viewbox)),e)},fromCamera:function(e,t){return r(a(o(t,e)),c.viewbox)}};return c},a=2*Math.PI,c={to:function(e){return e},from:function(e){return e}},u={to:function(e){var t=e[0],n=e[1];return n*=a,[t*Math.cos(n),t*Math.sin(n)]},from:function(e){var t=e[0],n=e[1];return[Math.sqrt(t*t+n*n),Math.atan2(n,t)/a]}},d=Object.freeze({__proto__:null,makeProjection:i,cartesian:c,polar:u});var s=function(e,t){void 0===e&&(e=[0,0]),void 0===t&&(t={});var n,r,o,i,a,c=Object.assign({friction:.02,threshold:.001},t),u=!1,d=e,s=0,f=[],v=window.performance.now.bind(window.performance);function l(e,t){void 0===t&&(t=1),u&&(f=d.slice(0),d[0]=n[0]+(e[0]-u[0])/t,d[1]=n[1]+(e[1]-u[1])/t,a=v())}return{start:function(e){u=e,n=d.slice(0)},drag:l,stop:function(e,t){if(u){r=f[0],o=f[1];var n=Math.max(20,v()-a);l(e,t),r=4*(d[0]-r)/n,o=4*(d[1]-o)/n,i=Math.sqrt(r*r+o*o),u=!1}},update:function(){var e=v();return u||function(e){if(r||o){var t=e-s;d[0]+=r*t,d[1]+=o*t,r&&(r-=c.friction*r),o&&(o-=c.friction*o),(r*r+o*o)/(i*i)<c.threshold*c.threshold&&(r=o=0)}}(e),s=e,d}}};e.createCanvas=function(e){var t=void 0===e?{}:e,n=t.autoResize,r=void 0===n||n,o=t.pixelRatio,i=void 0===o?window.devicePixelRatio||1:o,a=t.width,c=void 0===a?0:a,u=t.height,d=void 0===u?0:u,s=t.aspectRatio,f=void 0===s?null:s,v=t.el,l=void 0===v?document.body:v,m=t.background,h=void 0===m?"hsl(0, 0%, 10%)":m,w=t.onResize,p=void 0===w?function(){}:w,g="CANVAS"===l.tagName?l:document.createElement("canvas"),x=g.getContext("2d"),y=!c,b=!d,C={};g.style.display="flex",g.style.background=h,g.style.transform="scale("+1/i+")",g.style.transformOrigin="top left","CANVAS"!==l.tagName&&l.appendChild(g);var M=function(){var e=g.parentNode;e&&(y&&(c=e.clientWidth),b&&(d=f?c/f:e.clientHeight),C.width=c,C.height=d,g.style.marginBottom=(1-i)*d+"px",g.width=i*c,g.height=i*d,x.scale(i,i),p(C))};return r&&window.addEventListener("resize",M),M(),{canvas:g,ctx:x,destroy:function(){r&&window.removeEventListener("resize",M),g.parentNode&&g.parentNode.removeChild(g)},dimensions:C,refresh:M}},e.createDragger=s,e.createView=function(e,t,n,r){void 0===r&&(r={scaleMode:"fit"}),"string"==typeof e?e=d[e]:"object"!==e&&(n=t,t=e,e=c),Array.isArray(t)||(n=t,t=void 0);var o=i(e,t),a={center:[0,0],scale:1,proj:o},u={proj:o,init:function(e){e!==u.canvas&&(u.canvas=e,u.ctx=e.getContext("2d")),u.width=e.width,u.height=e.height,u.bounds=e.getBoundingClientRect();var t=u.width/u.bounds.width,n=.5*u.width/t,i=.5*u.height/t,c="fit"===r.scaleMode?Math.min(n,i):Math.max(n,i),d=c*a.scale,s=o.to(a.center);return u.cameraBounds=[-s[0]*d+n,(1-s[0])*d+n,-s[1]*d+i,(1-s[1])*d+i],u.worldUnit=[0,c,0,c],u.worldScale=[0,d,0,d],u.ctx.setTransform(t,0,0,t,0,0),u},save:function(){return u.ctx.save()},restore:function(){return u.ctx.restore()},clear:function(){u.ctx.clearRect(0,0,u.width,u.height)},color:function(e){return u.ctx.fillStyle!==e&&(u.ctx.fillStyle=e),u.ctx.strokeStyle!==e&&(u.ctx.strokeStyle=e),u},style:function(e,t){if(void 0!==t)return u.ctx[e]=t,u;for(var n in e){var r=e[n];u.ctx[n]!==r&&(u.ctx[n]=r)}return u},translate:function(e){var t=u.ctx,n=o.toCamera(u.worldScale,e),r=n[0],i=n[1];return t.translate(r,i),u},dot:function(e){var t=u.ctx,n=o.toCamera(u.cameraBounds,e),r=n[0],i=n[1];return t.beginPath(),t.arc(r,i,1,0,2*Math.PI),t.fill(),u},circle:function(e,t,n,r){void 0===n&&(n=!0),void 0===r&&(r=0);var i=u.ctx,a=o.toCamera(u.cameraBounds,e),c=a[0],d=a[1];return t=o.toCameraSize(u.cameraBounds,t),i.beginPath(),i.arc(c,d,t,0,2*Math.PI),n&&i.fill(),r&&(u.style("lineWidth",r),i.stroke()),u}};return a.toViewCoords=function(e,t,n){return void 0===n&&(n=!1),u.init(t),o.fromCamera(n?u.worldUnit:u.cameraBounds,e)},a.getMousePos=function(e,t,n){void 0===n&&(n=!1),u.init(t);var r=[e.pageX-u.bounds.left,e.pageY-u.bounds.top];return a.toViewCoords(r,t,n)},a.camera=function(e,t){return void 0===t&&(t=1),a.center=e,a.scale=t,a},a.draw=function(e){u.init(e),u.clear();for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return n.apply(void 0,[u].concat(r)),a},a.drawOver=function(e){u.init(e);for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return n.apply(void 0,[u].concat(r)),a},a},e.createViewport=function(e,t){void 0===t&&(t={});var n={center:[0,0],zoom:1},r=function(t){var n=e.getBoundingClientRect();return[-(t.pageX-n.left),-(t.pageY-n.top)]},o=s(n.center,t),i=function(e){e.preventDefault(),n.zoom=function(e,t,n){return void 0===n&&(n=1),e.zoom*Math.pow(2,t*n)}(n,-e.deltaY,.001)},a=function(e){o.start(r(e))},c=function(e){o.drag(r(e),n.zoom)},u=function(e){o.stop(r(e),n.zoom)};return e.addEventListener("wheel",i),e.addEventListener("mousedown",a),e.addEventListener("mousemove",c),window.addEventListener("mouseup",u),{state:n,update:function(){return n.center=o.update(),n},cleanup:function(){e.removeEventListener("wheel",i),e.removeEventListener("mousedown",a),e.removeEventListener("mousemove",c),window.removeEventListener("mouseup",u)}}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlldy1kcmF3Lm1pbi5qcyIsInNvdXJjZXMiOltdLCJzb3VyY2VzQ29udGVudCI6W10sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIifQ==
