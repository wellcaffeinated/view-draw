/**
 * view-draw 0.0.1
 * @license MIT
 * Copyright 2021-present Jasper Palfree
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).ViewDraw={})}(this,(function(t){"use strict";var e=function(t,e,i){return t*(1-i)+e*i},i=function(t,e,i){var n=e-t;return n?(i-t)/n:1},n=function(t,i){return[e(i[0],i[1],t[0]),e(i[2],i[3],t[1])]},r=function(t,e){return[i(e[0],e[1],t[0]),i(e[2],e[3],t[1])]},o=function(t,e){var i=t.name,o=t.to,a=t.from;void 0===e&&(e=[0,1,0,1]);var s={name:i,to:o,from:a,viewbox:e,toCameraSize:function(t,e){return(t[1]-t[0])*e/(s.viewbox[1]-s.viewbox[0])},fromCameraSize:function(t,e){var i=t[1]-t[0];return(s.viewbox[1]-s.viewbox[0])*e/i},toCamera:function(t,e){return n(o(r(e,s.viewbox)),t)},fromCamera:function(t,e){return n(a(r(e,t)),s.viewbox)}};return s},a=2*Math.PI,s={to:function(t){return t},from:function(t){return t}},c={to:function(t){var e=t[0],i=t[1];return i*=a,[e*Math.cos(i),e*Math.sin(i)]},from:function(t){var e=t[0],i=t[1];return[Math.sqrt(e*e+i*i),Math.atan2(i,e)/a]}},u=Object.freeze({__proto__:null,makeProjection:o,cartesian:s,polar:c});function h(t){for(var e=0,i=0,n=t.length,r=0;r<n;r++){var o=t[r];e+=o[0],i+=o[1]}return[e/n,i/n]}function d(t,e,i,n){void 0===n&&(n=!0);var r=Math.max(t,e,i);if(r===t){var o=[i,t];t=o[0],i=o[1]}else if(r===e){var a=[i,e];e=a[0],i=a[1]}var s=0===t?0:(t*t-e*e+i*i)/(2*i),c=[[0,0],[s,Math.sqrt(t*t-s*s)],[i,0]];if(n)for(var u=h(c),d=u[0],v=u[1],f=0,l=c.length;f<l;f++)c[f][0]-=d,c[f][1]-=v;return c}var v=Object.freeze({__proto__:null,centroid:h,triangleFromSides:d}),f=function(){function t(t,e){this.proj=t,this.options=e}t.create=function(e,i){return void 0===i&&(i={}),new t(e,i)};var e=t.prototype;return e.init=function(t,e){t!==this.canvas&&(this.canvas=t,this.ctx=t.getContext("2d")),this.width=t.width,this.height=t.height,this.bounds=t.getBoundingClientRect();var i=this.width/this.bounds.width,n=.5*this.width/i,r=.5*this.height/i,o="fit"===this.options.scaleMode?Math.min(n,r):Math.max(n,r),a=o*e.scale,s=this.proj.to(e.center);return this.cameraBounds=[-s[0]*a+n,(1-s[0])*a+n,-s[1]*a+r,(1-s[1])*a+r],this.worldUnit=[0,o,0,o],this.worldScale=[0,a,0,a],this.ctx.setTransform(i,0,0,i,0,0),this},e.save=function(){this.ctx.save()},e.restore=function(){this.ctx.restore()},e.clear=function(){this.ctx.clearRect(0,0,this.width,this.height)},e.color=function(t){return this.ctx.fillStyle!==t&&(this.ctx.fillStyle=t),this.ctx.strokeStyle!==t&&(this.ctx.strokeStyle=t),this},e.style=function(t,e){if(void 0!==e)return this.ctx[t]=e,this;for(var i in t){var n=t[i];this.ctx[i]!==n&&(this.ctx[i]=n)}return this},e.translate=function(t){var e=this.ctx,i=this.proj.toCamera(this.worldScale,t),n=i[0],r=i[1];return e.translate(n,r),this},e.rotate=function(t){var e=this.proj.toCamera(this.cameraBounds,[0,0]);return this.ctx.translate(e[0],e[1]),this.ctx.rotate(t),this.ctx.translate(-e[0],-e[1]),this},e.dot=function(t){var e=this.ctx,i=this.proj.toCamera(this.cameraBounds,t),n=i[0],r=i[1];return e.beginPath(),e.arc(n,r,1,0,2*Math.PI),e.fill(),this},e.paint=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=0);var i=this.ctx;return t&&i.fill(),e&&(this.style("lineWidth",e),i.stroke()),this},e.circle=function(t,e,i,n){void 0===i&&(i=!0),void 0===n&&(n=0);var r=this.ctx,o=this.proj.toCamera(this.cameraBounds,t),a=o[0],s=o[1];return e=this.proj.toCameraSize(this.cameraBounds,e),r.beginPath(),r.arc(a,s,e,0,2*Math.PI),this.paint(i,n),this},e.path=function(t,e,i,n){void 0===e&&(e=!1);var r=this.ctx;r.beginPath();var o=this.proj.toCamera(this.cameraBounds,t[0]);r.moveTo(o[0],o[1]);for(var a=1,s=t.length;a<s;a++)o=this.proj.toCamera(this.cameraBounds,t[a]),r.lineTo(o[0],o[1]);return e&&r.closePath(),this.paint(i,n),this},e.triangle=function(t,e,i,n,r,o,a){var s=void 0===n?[0,0]:n,c=s[0],u=s[1];void 0===r&&(r=0);var h=d(t,e,i);return this.save(),this.translate([c,u]),this.rotate(r),this.path(h,!0,o,a),this.restore(),this},t}();var l=function(t,e){void 0===t&&(t=[0,0]),void 0===e&&(e={});var i,n,r,o,a,s=Object.assign({friction:.02,threshold:.001},e),c=!1,u=t,h=0,d=[],v=window.performance.now.bind(window.performance);function f(t,e){void 0===e&&(e=1),c&&(d=u.slice(0),u[0]=i[0]+(t[0]-c[0])/e,u[1]=i[1]+(t[1]-c[1])/e,a=v())}return{start:function(t){c=t,i=u.slice(0)},drag:f,stop:function(t,e){if(c){n=d[0],r=d[1];var i=Math.max(20,v()-a);f(t,e),n=4*(u[0]-n)/i,r=4*(u[1]-r)/i,o=Math.sqrt(n*n+r*r),c=!1}},update:function(){var t=v();return c||function(t){if(n||r){var e=t-h;u[0]+=n*e,u[1]+=r*e,n&&(n-=s.friction*n),r&&(r-=s.friction*r),(n*n+r*r)/(o*o)<s.threshold*s.threshold&&(n=r=0)}}(t),h=t,u}}};t.createCanvas=function(t){var e=void 0===t?{}:t,i=e.autoResize,n=void 0===i||i,r=e.pixelRatio,o=void 0===r?window.devicePixelRatio||1:r,a=e.width,s=void 0===a?0:a,c=e.height,u=void 0===c?0:c,h=e.aspectRatio,d=void 0===h?null:h,v=e.el,f=void 0===v?document.body:v,l=e.background,m=void 0===l?"hsl(0, 0%, 10%)":l,p=e.onResize,w=void 0===p?function(){}:p,g="CANVAS"===f.tagName?f:document.createElement("canvas"),x=g.getContext("2d"),y=!s,b=!u,C={};g.style.display="flex",g.style.background=m,g.style.transform="scale("+1/o+")",g.style.transformOrigin="top left","CANVAS"!==f.tagName&&f.appendChild(g);var M=function(){var t=g.parentNode;t&&(y&&(s=t.clientWidth),b&&(u=d?s/d:t.clientHeight),C.width=s,C.height=u,g.style.marginBottom=(1-o)*u+"px",g.width=o*s,g.height=o*u,x.scale(o,o),w(C))};return n&&window.addEventListener("resize",M),M(),{canvas:g,ctx:x,destroy:function(){n&&window.removeEventListener("resize",M),g.parentNode&&g.parentNode.removeChild(g)},dimensions:C,refresh:M}},t.createDragger=l,t.createView=function(t,e,i,n){void 0===n&&(n={scaleMode:"fit"}),"string"==typeof t?t=u[t]:"object"!==t&&(i=e,e=t,t=s),Array.isArray(e)||(i=e,e=void 0);var r=o(t,e),a={center:[0,0],scale:1,proj:r},c=f.create(r,n);return a.toViewCoords=function(t,e,i){return void 0===i&&(i=!1),c.init(e,a),r.fromCamera(i?c.worldUnit:c.cameraBounds,t)},a.getMousePos=function(t,e,i){void 0===i&&(i=!1),c.init(e,a);var n=[t.pageX-c.bounds.left,t.pageY-c.bounds.top];return a.toViewCoords(n,e,i)},a.camera=function(t,e){return void 0===e&&(e=1),a.center=t,a.scale=e,a},a.draw=function(t){c.init(t,a),c.clear();for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return i.apply(void 0,[c].concat(n)),a},a.drawOver=function(t){c.init(t,a);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return i.apply(void 0,[c].concat(n)),a},a},t.createViewport=function(t,e){void 0===e&&(e={});var i={center:[0,0],zoom:1},n=function(e){var i=t.getBoundingClientRect();return[-(e.pageX-i.left),-(e.pageY-i.top)]},r=l(i.center,e),o=function(t){t.preventDefault(),i.zoom=function(t,e,i){return void 0===i&&(i=1),t.zoom*Math.pow(2,e*i)}(i,-t.deltaY,.001)},a=function(t){r.start(n(t))},s=function(t){r.drag(n(t),i.zoom)},c=function(t){r.stop(n(t),i.zoom)};return t.addEventListener("wheel",o),t.addEventListener("mousedown",a),t.addEventListener("mousemove",s),window.addEventListener("mouseup",c),{state:i,update:function(){return i.center=r.update(),i},cleanup:function(){t.removeEventListener("wheel",o),t.removeEventListener("mousedown",a),t.removeEventListener("mousemove",s),window.removeEventListener("mouseup",c)}}},t.geometry=v,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlldy1kcmF3Lm1pbi5qcyIsInNvdXJjZXMiOltdLCJzb3VyY2VzQ29udGVudCI6W10sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIifQ==
